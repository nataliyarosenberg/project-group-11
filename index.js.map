{"version":3,"file":"index.js","sources":["../src/img/icons.svg","../src/js/order-modal.js","../src/main.js"],"sourcesContent":["export default \"data:image/svg+xml,%3csvg%20aria-hidden='true'%20style='position:%20absolute;%20width:%200;%20height:%200;%20overflow:%20hidden;'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3csymbol%20id='icon-x-icon'%20viewBox='0%200%2032%2032'%3e%3cpath%20d='M21.589%208.459l-5.657%205.656-5.656-5.656-1.885%201.885%205.656%205.656-5.656%205.656%201.885%201.885%205.656-5.656%205.657%205.656%201.885-1.885-5.656-5.656%205.656-5.656-1.885-1.885z'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3c/svg%3e\"","import iconSprite from '../img/icons.svg';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nlet furnitureId = null;\nlet markerValue = null;\n\n// Функція для завантаження HTML модалки\nexport async function loadOrderModal() {\n  try {\n    // Додаємо SVG спрайт\n    if (!document.getElementById('svg-sprite')) {\n      const response = await fetch(iconSprite);\n      const svgText = await response.text();\n      const div = document.createElement('div');\n      div.style.position = 'absolute';\n      div.style.width = '0';\n      div.style.height = '0';\n      div.style.overflow = 'hidden';\n      div.id = 'svg-sprite';\n      div.innerHTML = svgText;\n      document.body.prepend(div);\n    }\n\n    const response = await fetch('./partials/order-modal.html');\n    const html = await response.text();\n    document.body.insertAdjacentHTML('beforeend', html);\n\n    const backdrop = document.querySelector('.backdrop');\n    const closeBtn = document.querySelector('.modal-button-close');\n    const form = document.querySelector('.modal-form');\n\n    if (backdrop) {\n      // Закриття по кліку на бекдроп\n      backdrop.addEventListener('click', e => {\n        if (e.target === backdrop) {\n          closeModal();\n        }\n      });\n\n      // Закриття по ESC\n      document.addEventListener('keydown', e => {\n        if (e.key === 'Escape' && backdrop.classList.contains('is-open')) {\n          closeModal();\n        }\n      });\n    }\n\n    if (closeBtn) {\n      closeBtn.addEventListener('click', closeModal);\n    }\n\n    if (form) {\n      form.addEventListener('submit', handleFormSubmit);\n    }\n  } catch (error) {\n    console.error('Помилка завантаження модалки:', error);\n  }\n}\n\nfunction closeModal() {\n  const backdrop = document.querySelector('.backdrop');\n  if (backdrop) {\n    backdrop.classList.remove('is-open');\n    document.body.style.overflow = '';\n    resetForm();\n  }\n}\n\nfunction resetForm() {\n  const form = document.querySelector('.modal-form');\n  if (form) {\n    form.reset();\n  }\n}\n\nasync function handleFormSubmit(e) {\n  e.preventDefault();\n\n  const form = e.target;\n  const formData = new FormData(form);\n  const data = {\n    name: formData.get('user-name'),\n    phone: formData.get('user-phone'),\n    comment: formData.get('user-comment'),\n    furnitureId,\n    marker: markerValue,\n  };\n\n  try {\n    const response = await fetch('/orders', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (response.ok) {\n      iziToast.success({\n        title: 'Успіх',\n        message: 'Ваше замовлення успішно відправлено!',\n        position: 'topRight',\n      });\n      closeModal();\n    } else {\n      // Safely handle potential non-JSON error responses\n      const contentType = response.headers.get('content-type');\n      if (contentType && contentType.indexOf('application/json') !== -1) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Помилка сервера');\n      } else {\n        const errorText = await response.text();\n        throw new Error(errorText || 'Помилка сервера');\n      }\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Помилка',\n      message: error.message || 'Не вдалося відправити форму',\n      position: 'topRight',\n    });\n  }\n}\n\nexport function toggleModal(open = true, id = null, marker = null) {\n  const backdrop = document.querySelector('.backdrop');\n  if (backdrop) {\n    backdrop.classList.toggle('is-open', open);\n    document.body.style.overflow = open ? 'hidden' : '';\n\n    if (open) {\n      furnitureId = id;\n      markerValue = marker;\n    }\n  }\n}\n\n//     // Додаємо обробники подій\n//     const backdrop = document.querySelector('.backdrop');\n//     if (backdrop) {\n//       backdrop.addEventListener('click', () => {\n//         backdrop.classList.remove('is-open');\n//       });\n//     }\n//   } catch (error) {\n//     console.error('Помилка завантаження модалки:', error);\n//   }\n// }\n\n// // Функція для відкриття/закриття модалки\n// export function toggleModal(open = true) {\n//   const backdrop = document.querySelector('.backdrop');\n//   if (backdrop) {\n//     backdrop.classList.toggle('is-open', open);\n//   }\n// }\n","import { loadOrderModal, toggleModal } from './js/order-modal.js';\n\n// Завантажуємо модалку при завантаженні сторінки\ndocument.addEventListener('DOMContentLoaded', () => {\n  loadOrderModal();\n\n  //   //  відкрити модалку по кліку на кнопку (якщо є)\n  //   const openModalBtn = document.querySelector('[data-modal-open]');\n  //   if (openModalBtn) {\n  //     openModalBtn.addEventListener('click', () => toggleModal(true));\n  //   }\n  // });\n\n  // Приклад відкриття модалки з даними\n  document.addEventListener('click', e => {\n    if (e.target.closest('[data-modal-open]')) {\n      const furnitureId = e.target.closest('[data-modal-open]').dataset.id;\n      const marker = e.target.closest('[data-modal-open]').dataset.marker;\n      toggleModal(true, furnitureId, marker);\n    }\n  });\n});\n"],"names":["iconSprite","furnitureId","markerValue","loadOrderModal","svgText","div","html","backdrop","closeBtn","form","e","closeModal","handleFormSubmit","error","resetForm","formData","data","response","iziToast","contentType","errorData","errorText","toggleModal","open","id","marker"],"mappings":"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"}