import{a as k,i as f,A as P}from"./assets/vendor-BOf7_0lP.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();const q=document.querySelector(".loader-more"),x=document.querySelector(".loader-more-container"),M=document.querySelector(".furniture-list"),C=document.querySelector(".load-more-btn");let a=1,l=null;const v=8;async function A(){try{const t=(await k("https://furniture-store.b.goit.study/api/categories")).data;t.unshift({_id:"0",name:"Всі товари"}),document.querySelectorAll(".category-card").forEach((s,n)=>{const r=t[n];if(!r)return;s.dataset.id=r._id;const c=s.querySelector(".category-title");c&&(c.textContent=r.name)})}catch{f.show({message:"Sorry, something went wrong. Please try again!",position:"topRight",messageColor:"#fff",titleColor:"#fff",color:"#ef4040",iconUrl:"../images/our-furniture/bi_x-octagon-2.svg",maxWidth:432})}}async function y(e=1,t){try{D(),w();let o=`https://furniture-store.b.goit.study/api/furnitures?limit=${v}&page=${e}`;t&&t!=="0"&&(o+=`&category=${t}`);const n=(await k(o)).data;j(n),l===null&&(l=Math.ceil(n.totalItems/v)),e>=l?w():H()}catch{f.show({message:"Sorry, something went wrong. Please try again!",position:"topRight",messageColor:"#fff",titleColor:"#fff",color:"#ef4040",iconUrl:"../images/our-furniture/bi_x-octagon-2.svg",maxWidth:432})}finally{F()}}function j(e){const t=e.furnitures;window.allFurnitures=t;const o=t.map(s=>{const{_id:n,name:r,description:c,price:i,images:T}=s;return`
    <li class="furniture-card" id="${n}"> 
  <img src="${T[0]}" alt="${c}" class="furniture-image" />
      <p class="furniture-name">${r}</p>
      <div class="color-wrap">
        <span class="grey-color"></span>
        <span class="beige-color"></span>
        <span class="black-color"></span>
      </div>
      <p class="furniture-price">${i} грн</p>
  <button class="details-btn" type="button">Детальніше</button>
</li>`}).join("");M.insertAdjacentHTML("beforeend",o)}async function B(e){const t=e.target.closest(".category-card");if(!t)return;document.querySelectorAll(".category-card.active").forEach(s=>s.classList.remove("active")),t.classList.add("active");const o=t.dataset.id;z(),a=1,o==="0"?(l=null,y(a)):(l=null,y(a,o))}function I(){a+=1,y(a)}function D(){q.classList.remove("hidden"),x.style.display="flex"}function F(){q.classList.add("hidden"),x.style.display="none"}function H(){C.classList.remove("hidden")}function w(){C.classList.add("hidden")}function z(){M.innerHTML=""}const N=document.querySelector(".categories-list"),R=document.querySelector(".load-more-btn");R.addEventListener("click",I);N.addEventListener("click",B);A();y(a);const g=document.querySelector(".modal"),E=document.querySelector(".modal_close"),u=document.querySelector(".modal_main-image img"),U=document.querySelector(".modal_title"),W=document.querySelector(".modal_category"),J=document.querySelector(".modal_price"),K=document.querySelector(".modal_description"),b=document.querySelector(".modal_rate"),L=document.querySelector(".color-checkboxes"),S=document.querySelector(".modal_sizes"),d=document.querySelector(".modal_order-btn"),h=document.querySelector(".modal_thumbnails");document.querySelector(".furniture-list").addEventListener("click",e=>{const t=e.target.closest(".details-btn");if(!t)return;const o=t.closest(".furniture-card"),s=o.dataset.id||o.id;if(!o||!s||!window.allFurnitures)return;const n=window.allFurnitures.find(r=>r._id===s);n&&V(n)});function $(e){e.key==="Escape"&&p()}function V(e){if(u.src=e.images?.[0]||"",u.alt=e.description||"",U.textContent=e.name||"Без назви",W.textContent=e.type||"Тип невідомий",J.textContent=`${e.price} грн`||"Ціна невідома",K.textContent=e.description||"Опис відсутній",d.dataset.model=e.name,b&&typeof e.rate=="number"){const t=Math.round(e.rate*10)/10,o=Math.min(5,t)/5*100;b.innerHTML=`
    <div class="star-rating" style="--star-fill: ${o}%"></div>
    <span class="rating-text">${t.toFixed(1)}</span>
  `}h&&Array.isArray(e.images)&&(h.innerHTML=e.images.slice(1).map(t=>`<img src="${t}" alt="${e.name}" class="thumbnail-img" />`).join("")),L&&Array.isArray(e.color)&&(L.innerHTML=e.color.map((t,o)=>{const s=`color-${o}`;return`
      <input type="radio" id="${s}" name="color" data-color="${t}" ${o===0?"checked":""} />
      <label for="${s}" style="background-color: ${t}"></label>
    `}).join("")),S&&(S.textContent=`Розміри: ${e.sizes||"невідомі"}`),d&&(d.dataset.id=e._id),g.classList.remove("visually-hidden"),h.addEventListener("click",t=>{const o=t.target.closest(".thumbnail-img");o&&(u.src=o.src,u.alt=o.alt)}),E.focus(),document.body.style.overflow="hidden",document.addEventListener("keydown",$)}function p(){g.classList.add("visually-hidden"),document.body.style.overflow="",document.removeEventListener("keydown",$)}E.addEventListener("click",p);g.addEventListener("click",e=>{e.target===g&&p()});d.addEventListener("click",()=>{p();const e=document.querySelector('.color-checkboxes input[type="radio"]:checked'),t=e?e.dataset.color:null,o=d.dataset.model,s=new CustomEvent("open-order-modal",{detail:{model:o,color:t}});document.body.style.overflow="",document.dispatchEvent(s)});const G="data:image/svg+xml,%3csvg%20aria-hidden='true'%20style='position:%20absolute;%20width:%200;%20height:%200;%20overflow:%20hidden;'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3csymbol%20id='icon-x-icon'%20viewBox='0%200%2032%2032'%3e%3cpath%20d='M21.589%208.459l-5.657%205.656-5.656-5.656-1.885%201.885%205.656%205.656-5.656%205.656%201.885%201.885%205.656-5.656%205.657%205.656%201.885-1.885-5.656-5.656%205.656-5.656-1.885-1.885z'%3e%3c/path%3e%3c/symbol%3e%3c/defs%3e%3c/svg%3e";let _=null,O=null;async function Q(){try{if(!document.getElementById("svg-sprite")){const c=await(await fetch(G)).text(),i=document.createElement("div");i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.id="svg-sprite",i.innerHTML=c,document.body.prepend(i)}const t=await(await fetch("./partials/order-modal.html")).text();document.body.insertAdjacentHTML("beforeend",t);const o=document.querySelector(".backdrop"),s=document.querySelector(".modal-button-close"),n=document.querySelector(".modal-form");o&&(o.addEventListener("click",r=>{r.target===o&&m()}),document.addEventListener("keydown",r=>{r.key==="Escape"&&o.classList.contains("is-open")&&m()})),s&&s.addEventListener("click",m),n&&n.addEventListener("submit",Y)}catch(e){console.error("Помилка завантаження модалки:",e)}}function m(){const e=document.querySelector(".backdrop");e&&(e.classList.remove("is-open"),document.body.style.overflow="",X())}function X(){const e=document.querySelector(".modal-form");e&&e.reset()}async function Y(e){e.preventDefault();const t=e.target,o=new FormData(t),s={name:o.get("user-name"),phone:o.get("user-phone"),comment:o.get("user-comment"),furnitureId:_,marker:O};try{const n=await fetch("/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(n.ok)f.success({title:"Успіх",message:"Ваше замовлення успішно відправлено!",position:"topRight"}),m();else{const r=n.headers.get("content-type");if(r&&r.indexOf("application/json")!==-1){const c=await n.json();throw new Error(c.message||"Помилка сервера")}else{const c=await n.text();throw new Error(c||"Помилка сервера")}}}catch(n){f.error({title:"Помилка",message:n.message||"Не вдалося відправити форму",position:"topRight"})}}function Z(e=!0,t=null,o=null){const s=document.querySelector(".backdrop");s&&(s.classList.toggle("is-open",e),document.body.style.overflow=e?"hidden":"",e&&(_=t,O=o))}function ee(){document.addEventListener("DOMContentLoaded",()=>{new P(".accordion",{duration:300,showMultiple:!1}).open(0)})}document.addEventListener("DOMContentLoaded",()=>{Q(),document.addEventListener("click",e=>{if(e.target.closest("[data-modal-open]")){const t=e.target.closest("[data-modal-open]").dataset.id,o=e.target.closest("[data-modal-open]").dataset.marker;Z(!0,t,o)}})});ee();
//# sourceMappingURL=index.js.map
